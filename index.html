// Pomocná funkce: převod Excel datumu na čitelný formát
function excelDateToJSDate(serial) {
  const utc_days = Math.floor(serial - 25569);
  const utc_value = utc_days * 86400;                                        
  const date_info = new Date(utc_value * 1000);

  const year = date_info.getUTCFullYear();
  const month = String(date_info.getUTCMonth() + 1).padStart(2, '0');
  const day = String(date_info.getUTCDate()).padStart(2, '0');

  return `${day}.${month}.${year}`;
}

// Pomocná funkce: převod Excel času na HH:MM
function excelTimeToString(timeSerial) {
  const totalSeconds = Math.round(timeSerial * 24 * 60 * 60);
  const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
  const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
  return `${hours}:${minutes}`;
}

function renderCalendar(events) {
  const container = document.getElementById('events');
  container.innerHTML = '';
  events.forEach(event => {
    let date = event.start_date;
    let time = event.start_time;

    // Převod datumu
    if (!isNaN(date)) date = excelDateToJSDate(Number(date));
    // Převod času
    if (!isNaN(time)) time = excelTimeToString(Number(time));

    const div = document.createElement('div');
    div.className = 'event';
    div.innerHTML = `<strong>${date} ${time}</strong><br>${event.title}<br>${event.place}`;
    container.appendChild(div);
  });
}
