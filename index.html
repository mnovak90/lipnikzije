<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shrnutí kulturních akcí</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: black;
        color: white;
        display: flex;
        height: 100vh;
        overflow: hidden;
    }
    .left {
        width: 40%;
        background-color: #272726;
        display: flex;
        flex-direction: column;
        padding: 20px;
        box-sizing: border-box;
        overflow: hidden;
    }
    .right {
        width: 60%;
        background-color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
        box-sizing: border-box;
    }
    .logo {
        width: 50%;
        height: auto;
        margin-bottom: 10px;
    }
    h2 {
        margin-top: 0;
        font-size: 1.2em;
        text-align: center;
        color: white;
    }
    .events {
        flex: 1;
        overflow: hidden;
        position: relative;
    }
    .event-list {
        display: flex;
        flex-direction: column;
        animation: scroll 40s linear infinite;
    }
    @keyframes scroll {
        0% { transform: translateY(0); }
        100% { transform: translateY(-50%); }
    }
    .event {
        margin-bottom: 20px;
    }
    .event-date {
        font-weight: bold;
        color: #92c83e;
    }
    .event-time {
        color: white;
    }
    .event-desc {
        white-space: nowrap;
        overflow: hidden;
        box-sizing: border-box;
    }
    .event-desc span {
        display: inline-block;
        padding-left: 100%;
        animation: marquee 15s linear infinite;
    }
    @keyframes marquee {
        0% { transform: translateX(0); }
        100% { transform: translateX(-100%); }
    }
    .poster {
        flex: 0 0 80%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .poster img {
        max-height: 100%;
        max-width: 100%;
        object-fit: contain;
    }
    .poster-text {
        flex: 0 0 20%;
        text-align: center;
        color: #272726;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .poster-title {
        font-weight: bold;
        margin-bottom: 5px;
    }
    .poster-details {
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        font-size: 1em;
    }
</style>
</head>
<body>

<div class="left">
    <img class="logo" src="https://mnovak90.github.io/lipnikzije/lipnikzije-bile.png" alt="Logo">
    <h2>SOUHRN KULTURNÍCH AKCÍ V LIPNÍKU</h2>
    <div class="events">
        <div class="event-list" id="event-list"></div>
    </div>
</div>

<div class="right">
    <div class="poster" id="poster"></div>
    <div class="poster-text">
        <div class="poster-title" id="poster-title"></div>
        <div class="poster-details" id="poster-details"></div>
    </div>
</div>

<script>
const sheetUrl = 'https://opensheet.elk.sh/1n8jsoPz6C3s7rMsmYFZzSkR5cKOodZsQ7sVRV2JuwMY/1';

fetch(sheetUrl)
    .then(res => res.json())
    .then(data => {
        // Seřazení podle start_date
        data.sort((a, b) => new Date(a.start_date) - new Date(b.start_date));

        const eventList = document.getElementById('event-list');

        data.forEach(event => {
            if (!event.start_date || !event.title) return;

            let start = formatDate(event.start_date);
            let dateText = start;
            if (event.end_date) {
                dateText += ' - ' + formatDate(event.end_date);
            }

            const eventDiv = document.createElement('div');
            eventDiv.classList.add('event');

            eventDiv.innerHTML = `
                <div class="event-date">${dateText}</div>
                <div class="event-time">${event.time || ''}</div>
                ${event.description ? `<div class="event-desc"><span>${event.description}</span></div>` : ''}
            `;
            eventList.appendChild(eventDiv);
        });

        startPosterSlideshow(data);
    });

function formatDate(dateStr) {
    const d = new Date(dateStr);
    let day = String(d.getDate()).padStart(2, '0');
    let month = String(d.getMonth() + 1).padStart(2, '0');
    let year = d.getFullYear();
    return `${day}. ${month}. ${year}`;
}

function startPosterSlideshow(data) {
    let index = 0;
    const poster = document.getElementById('poster');
    const title = document.getElementById('poster-title');
    const details = document.getElementById('poster-details');

    function showPoster() {
        const event = data[index];
        poster.innerHTML = event.image ? `<img src="${event.image}" alt="${event.title}">` : '';
        title.textContent = event.title || '';
        details.textContent = event.details || '';

        index = (index + 1) % data.length;
    }

    showPoster();
    setInterval(showPoster, 5000);
}
</script>

</body>
</html>
