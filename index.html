<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>LIPNÍK ŽIJE</title>
<meta http-equiv="refresh" content="3600"> <!-- aktualizace každou hodinu -->
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        display: flex;
        height: 100vh;
        background: url('https://mnovak90.github.io/lipnikzije/bg.jpg') no-repeat center center fixed;
        background-size: cover;
        color: white;
    }
    .left {
        width: 35%;
        background-color: #272726;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }
    .left img.logo {
        max-width: 200px;
        margin-bottom: 20px;
    }
    h2 {
        color: white;
        margin-bottom: 20px;
        font-size: 28px;
    }
    .event {
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(255,255,255,0.2);
        padding-bottom: 10px;
    }
    .event-date {
        color: #12a537;
        font-weight: bold;
        font-size: 18px;
    }
    .event-title {
        font-size: 20px;
        font-weight: bold;
        margin: 5px 0;
    }
    .event-place {
        font-size: 16px;
        opacity: 0.8;
    }
    .right {
        width: 65%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
    }
    .poster-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    .poster-container img {
        max-width: 100%;
        max-height: 70%;
        object-fit: contain;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.5);
    }
    .poster-info {
        color: #272726;
        background: rgba(255,255,255,0.9);
        padding: 15px;
        border-radius: 8px;
        margin-top: 15px;
        text-align: center;
        max-width: 90%;
    }
    .poster-title {
        font-size: 22px;
        font-weight: bold;
        margin-bottom: 5px;
    }
    .poster-description {
        font-size: 16px;
    }
</style>
</head>
<body>

<div class="left">
    <img src="https://mnovak90.github.io/lipnikzije/lipnikzije-bile.png" class="logo" alt="LIPNÍK ŽIJE">
    <h2>Kalendář akcí</h2>
    <div id="events"></div>
</div>

<div class="right">
    <div class="poster-container">
        <img id="poster" src="" alt="Plakát akce">
        <div class="poster-info">
            <div class="poster-title" id="poster-title"></div>
            <div class="poster-description" id="poster-description"></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
async function loadData() {
    const response = await fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2ppsqGwnoqU4XvAxp-SYbQtzzoLxFcaKT5X8iojVLPDvyHGpOVYQDztvFaRdOm-9SzDoFZ9PNoKKZ/pub?output=xlsx");
    const arrayBuffer = await response.arrayBuffer();
    const workbook = XLSX.read(arrayBuffer, { type: "array" });
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    const data = XLSX.utils.sheet_to_json(sheet);

    // Vyčištění a formátování
    const eventsList = document.getElementById("events");
    eventsList.innerHTML = "";

    const posters = [];

    data.forEach(event => {
        // Formátování datumu
        let startDate = new Date((event.start_date - 25569) * 86400 * 1000);
        let endDate = event.end_date ? new Date((event.end_date - 25569) * 86400 * 1000) : null;

        let dateString = startDate.toLocaleDateString("cs-CZ", { day: "2-digit", month: "2-digit" });
        if (endDate && endDate.getTime() !== startDate.getTime()) {
            dateString += " - " + endDate.toLocaleDateString("cs-CZ", { day: "2-digit", month: "2-digit" });
        }

        // Levý panel
        const div = document.createElement("div");
        div.className = "event";
        div.innerHTML = `
            <div class="event-date">${dateString}</div>
            <div class="event-title">${event.title}</div>
            <div class="event-place">${event.place || ""}</div>
        `;
        eventsList.appendChild(div);

        // Pravý panel - plakáty
        if (event.poster_url) {
            posters.push({
                url: event.poster_url,
                title: event.title || "",
                description: event.description || ""
            });
        }
    });

    // Rotace plakátů
    let index = 0;
    function showPoster() {
        const p = posters[index];
        document.getElementById("poster").src = p.url;
        document.getElementById("poster-title").innerText = p.title;
        document.getElementById("poster-description").innerText = p.description;
        index = (index + 1) % posters.length;
    }
    showPoster();
    setInterval(showPoster, 8000);
}

loadData();
</script>

</body>
</html>
